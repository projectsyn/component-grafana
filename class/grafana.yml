parameters:
  kapitan:
    dependencies:
      - type: helm
        source: https://grafana.github.io/helm-charts
        chart_name: grafana
        version: ${grafana:charts:grafana}
        output_path: dependencies/grafana/helmcharts/grafana
    compile:
      - input_paths:
          - grafana/component/app.jsonnet
        input_type: jsonnet
        output_path: apps/
      - input_paths:
          - grafana/component/main.jsonnet
        input_type: jsonnet
        output_path: grafana/
      - input_type: helm
        input_paths:
          - grafana/helmcharts/grafana
        helm_values:
          image:
            repository: ${grafana:images:grafana:image}
            tag: ${grafana:images:grafana:tag}
            pullPolicy: ${grafana:images:grafana:pullPolicy}
          downloadDashboardsImage:
            repository: ${grafana:images:downloadDashboardsImage:image}
            tag: ${grafana:images:downloadDashboardsImage:tag}
          ingress:
            enabled: ${grafana:ingress:enabled}
            hosts: ${grafana:ingress:hosts}
            tls: ${grafana:ingress:tls}
            annotations: ${grafana:ingress:annotations}
          persistence:
            enabled: ${grafana:persistence:enabled}
            size: ${grafana:persistence:size}
            storageClassName: ${grafana:persistence:storageClassName}
          serviceMonitor:
            enabled: ${grafana:serviceMonitor:enabled}
        helm_params:
          namespace: ${grafana:namespace}
        output_path: grafana/01_helmchart
